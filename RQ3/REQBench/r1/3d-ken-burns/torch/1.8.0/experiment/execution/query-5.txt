
                        **Debug Mission** 
                        Resolve runtime crash caused by code-level incompatibilities in dependency chain.

                        **Input Context**
                        - Current environment: charset-normalizer==2.1.1
click==8.1.3
coverage==6.5.0
cupy-cuda102==7.8.0
dataclasses==0.6
decorator==4.4.2
dill==0.3.7
fastrlock==0.8.1
Flask==2.2.2
future==0.18.3
gevent==20.9.0
greenlet==2.0.1
h5py==3.7.0
idna==3.4
imageio==2.22.4
imageio-ffmpeg==0.4.7
importlib-metadata==4.0.0
itsdangerous==2.1.2
Jinja2==3.1.2
MarkupSafe==2.1.1
moviepy==1.0.3
numpy==1.19.5
opencv-contrib-python==4.6.0.66
Pillow==9.3.0
proglog==0.1.10
requests==2.28.1
scipy==1.5.4
torch==1.8.0
torchvision==0.9.0
tqdm==4.64.1
typing_extensions==4.4.0
urllib3==1.26.15
Werkzeug==2.2.2
zipp==3.11.0
zope.event==4.5.0
zope.interface==5.5.1

                        - Python version: 3.7
                        - Project source code: #!/usr/bin/env python

import base64
import cupy
import cv2
import flask
import getopt
import gevent
import gevent.pywsgi
import glob
import h5py
import io
import math
import moviepy
import moviepy.editor
import numpy
import os
import random
import re
import scipy
import scipy.io
import shutil
import sys
import tempfile
import time
import torch
import torchvision
import urllib
import zipfile

##########################################################

assert(int(str('').join(torch.__version__.split('.')[0:2])) >= 12) # requires at least pytorch version 1.2.0

torch.set_grad_enabled(False) # make sure to not compute gradients for computational performance

torch.backends.cudnn.enabled = True # make sure to use cudnn for computational performance

##########################################################

objCommon = {}

exec(open('./common.py', 'r').read())

exec(open('./models/disparity-estimation.py', 'r').read())
exec(open('./models/disparity-adjustment.py', 'r').read())
exec(open('./models/disparity-refinement.py', 'r').read())
exec(open('./models/pointcloud-inpainting.py', 'r').read())

##########################################################

arguments_strIn = './images/doublestrike.jpg'
arguments_strOut = './depthestim.npy'

for strOption, strArgument in getopt.getopt(sys.argv[1:], '', [ strParameter[2:] + '=' for strParameter in sys.argv[1::2] ])[0]:
	if strOption == '--in' and strArgument != '': arguments_strIn = strArgument # path to the input image
	if strOption == '--out' and strArgument != '': arguments_strOut = strArgument # path to where the output should be stored
# end

##########################################################

if __name__ == '__main__':
	npyImage = cv2.imread(filename=arguments_strIn, flags=cv2.IMREAD_COLOR)

	fltFocal = max(npyImage.shape[1], npyImage.shape[0]) / 2.0
	fltBaseline = 40.0

	tenImage = torch.FloatTensor(numpy.ascontiguousarray(npyImage.transpose(2, 0, 1)[None, :, :, :].astype(numpy.float32) * (1.0 / 255.0))).cuda()
	tenDisparity = disparity_estimation(tenImage)
	tenDisparity = disparity_refinement(torch.nn.functional.interpolate(input=tenImage, size=(tenDisparity.shape[2] * 4, tenDisparity.shape[3] * 4), mode='bilinear', align_corners=False), tenDisparity)
	tenDisparity = torch.nn.functional.interpolate(input=tenDisparity, size=(tenImage.shape[2], tenImage.shape[3]), mode='bilinear', align_corners=False) * (max(tenImage.shape[2], tenImage.shape[3]) / 256.0)
	tenDepth = (fltFocal * fltBaseline) / (tenDisparity + 0.0000001)

	npyDisparity = tenDisparity[0, 0, :, :].cpu().numpy()
	npyDepth = tenDepth[0, 0, :, :].cpu().numpy()

	cv2.imwrite(filename=arguments_strOut.replace('.npy', '.png'), img=(npyDisparity / fltBaseline * 255.0).clip(0.0, 255.0).astype(numpy.uint8))

	numpy.save(arguments_strOut, npyDepth)
# end
                        - library source code: from cupy.core import core  # NOQA
from cupy.core import internal  # NOQA


# import class and function
from cupy.core._errors import _AxisError  # NOQA
from cupy.core._kernel import create_reduction_func  # NOQA
from cupy.core._kernel import create_ufunc  # NOQA
from cupy.core._kernel import ElementwiseKernel  # NOQA
from cupy.core._kernel import ReductionKernel  # NOQA
from cupy.core._kernel import ufunc  # NOQA
from cupy.core._routines_manipulation import array_split  # NOQA
from cupy.core._routines_manipulation import broadcast  # NOQA
from cupy.core._routines_manipulation import broadcast_to  # NOQA
from cupy.core._routines_manipulation import concatenate_method  # NOQA
from cupy.core._routines_manipulation import moveaxis  # NOQA
from cupy.core._routines_manipulation import rollaxis  # NOQA
from cupy.core._routines_manipulation import size  # NOQA'
from cupy.core._routines_math import absolute  # NOQA
from cupy.core._routines_math import add  # NOQA
from cupy.core._routines_math import angle  # NOQA
from cupy.core._routines_math import conj  # NOQA
from cupy.core._routines_math import divide  # NOQA
from cupy.core._routines_math import floor_divide  # NOQA
from cupy.core._routines_math import imag  # NOQA
from cupy.core._routines_math import multiply  # NOQA
from cupy.core._routines_math import negative  # NOQA
from cupy.core._routines_math import power  # NOQA
from cupy.core._routines_math import real  # NOQA
from cupy.core._routines_math import remainder  # NOQA
from cupy.core._routines_math import sqrt  # NOQA
from cupy.core._routines_math import subtract  # NOQA
from cupy.core._routines_math import true_divide  # NOQA
from cupy.core._routines_statistics import nanmax  # NOQA
from cupy.core._routines_statistics import nanmin  # NOQA
from cupy.core.core import _internal_ascontiguousarray  # NOQA
from cupy.core.core import _internal_asfortranarray  # NOQA
from cupy.core.core import array  # NOQA
from cupy.core.core import ascontiguousarray  # NOQA
from cupy.core.core import asfortranarray  # NOQA
from cupy.core.core import bitwise_and  # NOQA
from cupy.core.core import bitwise_or  # NOQA
from cupy.core.core import bitwise_xor  # NOQA
from cupy.core.core import create_comparison  # NOQA
from cupy.core.core import divmod  # NOQA
from cupy.core.core import dot  # NOQA
from cupy.core.core import elementwise_copy  # NOQA
from cupy.core.core import elementwise_copy_where  # NOQA
from cupy.core.core import equal  # NOQA
from cupy.core.core import greater  # NOQA
from cupy.core.core import greater_equal  # NOQA
from cupy.core.core import invert  # NOQA
from cupy.core.core import left_shift  # NOQA
from cupy.core.core import less  # NOQA
from cupy.core.core import less_equal  # NOQA
from cupy.core.core import matmul  # NOQA
from cupy.core.core import ndarray  # NOQA
from cupy.core.core import not_equal  # NOQA
from cupy.core.core import right_shift  # NOQA
from cupy.core.core import tensordot_core  # NOQA
from cupy.core.dlpack import fromDlpack  # NOQA
from cupy.core.internal import complete_slice  # NOQA
from cupy.core.internal import get_size  # NOQA
from cupy.core.raw import RawKernel  # NOQA
from cupy.core.raw import RawModule  # NOQA

                        - PyPI metadata (including version constraints): ['typing-extensions', 'numpy', 'dataclasses ; python_version < "3.7"']
                        - Crash traceback: Traceback (most recent call last):
  File "/home/lei/anaconda3/envs/py37-3/lib/python3.7/site-packages/cupy/__init__.py", line 21, in <module>
    from cupy import core  # NOQA
  File "/home/lei/anaconda3/envs/py37-3/lib/python3.7/site-packages/cupy/core/__init__.py", line 1, in <module>
    from cupy.core import core  # NOQA
ImportError: libcudart.so.10.2: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "depthestim.py", line 4, in <module>
    import cupy
  File "/home/lei/anaconda3/envs/py37-3/lib/python3.7/site-packages/cupy/__init__.py", line 42, in <module>
    six.reraise(ImportError, ImportError(msg), exc_info[2])
  File "/home/lei/anaconda3/envs/py37-3/lib/python3.7/site-packages/six.py", line 723, in reraise
    raise value.with_traceback(tb)
  File "/home/lei/anaconda3/envs/py37-3/lib/python3.7/site-packages/cupy/__init__.py", line 21, in <module>
    from cupy import core  # NOQA
  File "/home/lei/anaconda3/envs/py37-3/lib/python3.7/site-packages/cupy/core/__init__.py", line 1, in <module>
    from cupy.core import core  # NOQA
ImportError: CuPy is not correctly installed.

If you are using wheel distribution (cupy-cudaXX), make sure that the version of CuPy you installed matches with the version of CUDA on your host.
Also, confirm that only one CuPy package is installed:
  $ pip freeze

If you are building CuPy from source, please check your environment, uninstall CuPy and reinstall it with:
  $ pip install cupy --no-cache-dir -vvvv

Check the Installation Guide for details:
  https://docs.cupy.dev/en/latest/install.html

original error: libcudart.so.10.2: cannot open shared object file: No such file or directory


                        **Analysis Protocol**
                        1. Traceback Pattern Matching：
                        a. Identify error type (ImportError/AttributeError/TypeError)
                        b. Map to possible API changes in torch v1.8.0 or its dependencies
                        2. Compatibility Matrix Check：
                        a. Verify library-to-library API compatibility through version ranges
                        b. Confirm project-to-library interface compatibility
                        3. Breakpoint Isolation：
                        b. Determine if conflict originates from：
                            • Direct API changes in torch
                            • Transitive dependency API shifts

                        **Resolution Rules**
                        - PRIMARY CONSTRAINT: Maintain torch==1.8.0
                        - SECONDARY ADJUSTMENTS: 
                        • Modify dependency versions only when API contracts allow
                        • Prefer backward-compatible minor version changes

                        **Output Mandates**
                        STRICT FORMAT:
                        lib1==x.y.z  
                        lib2==a.b.c
                        ...
                        PROHIBITED:
                        • Any non-version text.
                        • Library additions/removals
                        • Version placeholders
                        MANDATORY:
                        • Preserve original library names and count
                        • Pin EXACT versions
                        • Zero explanations/comments
                        